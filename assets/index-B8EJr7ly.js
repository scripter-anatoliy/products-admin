import{c as q,j as t,u as W}from"./index-BWwep_31.js";import{r as f,T as R,I as B,B as k,d as U,F as b,e as K,f as z,h as H,A as G,i as Q,S as J,j as Y}from"./vendor-antd-CdNXofhI.js";import{g as X,p as e1}from"./base-zaLYROFo.js";import"./vendor-react-Z7xbAZzq.js";function t1(n,s){let e;try{e=n()}catch{return}return{getItem:c=>{var i;const m=d=>d===null?null:JSON.parse(d,void 0),h=(i=e.getItem(c))!=null?i:null;return h instanceof Promise?h.then(m):m(h)},setItem:(c,i)=>e.setItem(c,JSON.stringify(i,void 0)),removeItem:c=>e.removeItem(c)}}const Z=n=>s=>{try{const e=n(s);return e instanceof Promise?e:{then(a){return Z(a)(e)},catch(a){return this}}}catch(e){return{then(a){return this},catch(a){return Z(a)(e)}}}},n1=(n,s)=>(e,a,c)=>{let i={storage:t1(()=>window.localStorage),partialize:o=>o,version:0,merge:(o,j)=>({...j,...o}),...s},m=!1,h=0;const d=new Set,g=new Set;let _=i.storage;if(!_)return n((...o)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),e(...o)},a,c);const I=()=>{const o=i.partialize({...a()});return _.setItem(i.name,{state:o,version:i.version})},C=c.setState;c.setState=(o,j)=>(C(o,j),I());const l=n((...o)=>(e(...o),I()),a,c);c.getInitialState=()=>l;let r;const u=()=>{var o,j;if(!_)return;const E=++h;m=!1,d.forEach(w=>{var v;return w((v=a())!=null?v:l)});const N=((j=i.onRehydrateStorage)==null?void 0:j.call(i,(o=a())!=null?o:l))||void 0;return Z(_.getItem.bind(_))(i.name).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==i.version){if(i.migrate){const v=i.migrate(w.state,w.version);return v instanceof Promise?v.then(L=>[!0,L]):[!0,v]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,w.state];return[!1,void 0]}).then(w=>{var v;if(E!==h)return;const[L,O]=w;if(r=i.merge(O,(v=a())!=null?v:l),e(r,!0),L)return I()}).then(()=>{E===h&&(N==null||N(r,void 0),r=a(),m=!0,g.forEach(w=>w(r)))}).catch(w=>{E===h&&(N==null||N(void 0,w))})};return c.persist={setOptions:o=>{i={...i,...o},o.storage&&(_=o.storage)},clearStorage:()=>{_==null||_.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>u(),hasHydrated:()=>m,onHydrate:o=>(d.add(o),()=>{d.delete(o)}),onFinishHydration:o=>(g.add(o),()=>{g.delete(o)})},i.skipHydration||u(),r||l},s1=n1,r1="products-ui",$={title:220,price:100,brand:140,sku:120,rating:100,minimumOrderQuantity:120},P={items:[],loading:!1,error:null,searchQuery:"",sortBy:null,sortOrder:"asc",columnWidths:{...$},localEdits:{}},x=q()(s1((n,s)=>({...P,setItems:e=>n({items:e,error:null}),setLoading:e=>n({loading:e}),setError:e=>n({error:e}),setSearchQuery:e=>n({searchQuery:e}),setSort:(e,a)=>n(c=>({sortBy:e,sortOrder:a??(c.sortBy===e&&c.sortOrder==="asc"?"desc":"asc")})),setColumnWidth:(e,a)=>n(c=>({columnWidths:{...c.columnWidths,[e]:Math.max(60,a)}})),setColumnWidths:e=>n({columnWidths:{...$,...e}}),patchLocalEdit:(e,a)=>n(c=>({localEdits:{...c.localEdits,[e]:{...c.localEdits[e],...a}}})),clearLocalEdit:e=>n(a=>{const c={...a.localEdits};return delete c[e],{localEdits:c}}),addLocalProduct:e=>n(a=>({items:[e,...a.items]})),getProduct:e=>{const a=s(),c=a.items.find(m=>m.id===e);if(!c)return;const i=a.localEdits[e];return i?{...c,...i}:c},reset:()=>n(P)}),{name:r1,partialize:n=>({sortBy:n.sortBy,sortOrder:n.sortOrder,columnWidths:n.columnWidths})})),o1="_cellWrapper_13l67_1",a1="_inputFullWidth_13l67_41",i1="_priceDecimals_13l67_83",A={cellWrapper:o1,inputFullWidth:a1,priceDecimals:i1};function M({productId:n,field:s,value:e,className:a}){const c=x(r=>r.patchLocalEdit),[i,m]=f.useState(!1),[h,d]=f.useState(s==="price"?typeof e=="number"?e:0:String(e??""));f.useEffect(()=>{d(s==="price"?typeof e=="number"?e:0:String(e??""))},[e,s]);const g=f.useCallback(()=>{if(m(!1),s==="price"){const r=typeof h=="number"?h:parseFloat(String(h).replace(",","."));!Number.isNaN(r)&&r>=0&&c(n,{price:r})}else{const r=String(h).trim();r!==String(e??"")&&c(n,{[s]:r})}},[s,h,n,e,c]),_=f.useCallback(r=>{r.key==="Enter"&&g(),r.key==="Escape"&&m(!1)},[g]),I=f.useCallback(r=>{["Backspace","Tab","Enter","Escape","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Delete"].includes(r.key)||/^[0-9.,]$/.test(r.key)||r.preventDefault()},[]),C=f.useCallback(r=>{const u=r.replace(/[^\d.,]/g,"").replace(",","."),o=parseFloat(u);return Number.isNaN(o)?0:o},[]);if(i)return s==="price"?t.jsx(R,{value:h,onChange:r=>d(r??0),onBlur:g,onKeyDown:r=>{I(r),_(r)},parser:r=>r?C(String(r)):0,min:0,step:.01,size:"small",className:A.inputFullWidth,autoFocus:!0,controls:!1}):t.jsx(B,{value:h,onChange:r=>d(r.target.value),onBlur:g,onKeyDown:_,size:"small",autoFocus:!0});const l=s==="price"&&typeof e=="number"?(()=>{const r=new Intl.NumberFormat("ru-RU",{minimumFractionDigits:2,maximumFractionDigits:2,useGrouping:!0}).format(e),u=r.lastIndexOf(",");if(u===-1)return r;const o=r.slice(0,u),j=r.slice(u+1);return t.jsxs(t.Fragment,{children:[`${o},`,t.jsx("span",{className:A.priceDecimals,children:j})]})})():String(e??"—");return t.jsx("div",{role:"button",tabIndex:0,onClick:()=>m(!0),onKeyDown:r=>r.key==="Enter"&&m(!0),className:[A.cellWrapper,"ant-table-cell-edit",a].filter(Boolean).join(" "),children:l})}const c1="_wrap_lni7l_1",l1="_label_lni7l_13",d1="_inputWrap_lni7l_25",u1="_input_lni7l_25",C1="_inputError_lni7l_69",h1="_rightSlot_lni7l_87",p1="_error_lni7l_103",S={wrap:c1,label:l1,inputWrap:d1,input:u1,inputError:C1,rightSlot:h1,error:p1};f.forwardRef(function({label:s,error:e,rightSlot:a,className:c="",id:i,...m},h){const d=i??`input-${Math.random().toString(36).slice(2)}`;return t.jsxs("div",{className:`${S.wrap} ${c}`.trim(),children:[s&&t.jsx("label",{className:S.label,htmlFor:d,children:s}),t.jsxs("div",{className:S.inputWrap,children:[t.jsx("input",{ref:h,id:d,className:`${S.input} ${e?S.inputError:""}`.trim(),"aria-invalid":!!e,"aria-describedby":e?`${d}-error`:void 0,...m}),a&&t.jsx("span",{className:S.rightSlot,children:a})]}),e&&t.jsx("p",{id:`${d}-error`,className:S.error,role:"alert",children:e})]})});const F=6,T=2,D=18,m1=3,g1=5,_1="#949494",f1="#D8D8D8";function x1({value:n,max:s=100,barCount:e=g1}){const a=s<=0?0:Math.min(1,Math.max(0,n/s)),c=Math.round(a*e),i=e*F+(e-1)*T;return t.jsx("svg",{width:i,height:D,viewBox:`0 0 ${i} ${D}`,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:Array.from({length:e},(m,h)=>{const d=h*(F+T),g=h<c?_1:f1;return t.jsx("rect",{x:d,y:0,width:F,height:D,rx:m1,fill:g},h)})})}function w1({size:n=28,className:s,...e}){return t.jsx("svg",{width:n,height:n,viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:s,...e,children:t.jsx("path",{d:"M14 2.625C11.7502 2.625 9.551 3.29213 7.68039 4.54203C5.80978 5.79193 4.35181 7.56847 3.49087 9.64698C2.62992 11.7255 2.40466 14.0126 2.84356 16.2192C3.28247 18.4257 4.36584 20.4525 5.95666 22.0433C7.54748 23.6342 9.57431 24.7175 11.7808 25.1564C13.9874 25.5953 16.2745 25.3701 18.353 24.5091C20.4315 23.6482 22.2081 22.1902 23.458 20.3196C24.7079 18.449 25.375 16.2498 25.375 14C25.3718 10.9841 24.1724 8.09271 22.0398 5.96018C19.9073 3.82764 17.0159 2.62818 14 2.625ZM23.5845 13.125H19.2281C19.0739 10.0122 18.1048 7.05797 16.4806 4.70312C18.3829 5.21383 20.0832 6.29458 21.3532 7.80013C22.6231 9.30567 23.4018 11.1639 23.5845 13.125ZM14 23.613C11.9514 21.3959 10.7089 18.2536 10.5252 14.875H17.4748C17.2911 18.2514 16.0486 21.3959 14 23.613ZM10.5252 13.125C10.7089 9.74859 11.947 6.60406 14 4.38703C16.0486 6.60406 17.2911 9.74641 17.4748 13.125H10.5252ZM11.5194 4.70312C9.89515 7.05797 8.92609 10.0122 8.77187 13.125H4.41547C4.59821 11.1639 5.37688 9.30567 6.64682 7.80013C7.91676 6.29458 9.61711 5.21383 11.5194 4.70312ZM4.41547 14.875H8.77187C8.92609 17.9878 9.89515 20.942 11.5194 23.2969C9.61711 22.7862 7.91676 21.7054 6.64682 20.1999C5.37688 18.6943 4.59821 16.8361 4.41547 14.875ZM16.4806 23.2969C18.1048 20.9387 19.0739 17.9845 19.2281 14.875H23.5845C23.4018 16.8361 22.6231 18.6943 21.3532 20.1999C20.0832 21.7054 18.3829 22.7862 16.4806 23.2969Z",fill:"currentColor"})})}function j1({size:n=28,className:s,...e}){return t.jsx("svg",{width:n,height:n,viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:s,...e,children:t.jsx("path",{d:"M24.2594 19.2434C23.6523 18.1978 22.75 15.2392 22.75 11.375C22.75 9.05436 21.8281 6.82876 20.1872 5.18782C18.5462 3.54687 16.3206 2.625 14 2.625C11.6794 2.625 9.45376 3.54687 7.81281 5.18782C6.17187 6.82876 5.25 9.05436 5.25 11.375C5.25 15.2403 4.34656 18.1978 3.73953 19.2434C3.58451 19.5093 3.50233 19.8113 3.50128 20.119C3.50022 20.4267 3.58033 20.7293 3.73351 20.9962C3.8867 21.2631 4.10755 21.4848 4.3738 21.6391C4.64005 21.7934 4.94227 21.8748 5.25 21.875H9.71359C9.91547 22.8628 10.4523 23.7506 11.2334 24.3882C12.0145 25.0258 12.9918 25.374 14 25.374C15.0082 25.374 15.9855 25.0258 16.7666 24.3882C17.5477 23.7506 18.0845 22.8628 18.2864 21.875H22.75C23.0576 21.8746 23.3597 21.7931 23.6258 21.6387C23.8919 21.4843 24.1126 21.2625 24.2657 20.9957C24.4187 20.7288 24.4987 20.4263 24.4976 20.1187C24.4965 19.8111 24.4143 19.5092 24.2594 19.2434ZM14 23.625C13.4573 23.6248 12.928 23.4565 12.4849 23.1431C12.0419 22.8297 11.7068 22.3867 11.5259 21.875H16.4741C16.2932 22.3867 15.9581 22.8297 15.5151 23.1431C15.072 23.4565 14.5427 23.6248 14 23.625ZM5.25 20.125C6.09219 18.6769 7 15.3212 7 11.375C7 9.51848 7.7375 7.73801 9.05025 6.42525C10.363 5.1125 12.1435 4.375 14 4.375C15.8565 4.375 17.637 5.1125 18.9497 6.42525C20.2625 7.73801 21 9.51848 21 11.375C21 15.318 21.9056 18.6736 22.75 20.125H5.25Z",fill:"currentColor"})})}function y1({size:n=28,className:s,...e}){return t.jsx("svg",{width:n,height:n,viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:s,...e,children:t.jsx("path",{d:"M24.5 5.25H3.5C3.26794 5.25 3.04538 5.34219 2.88128 5.50628C2.71719 5.67038 2.625 5.89294 2.625 6.125V21C2.625 21.4641 2.80937 21.9092 3.13756 22.2374C3.46575 22.5656 3.91087 22.75 4.375 22.75H23.625C24.0891 22.75 24.5342 22.5656 24.8624 22.2374C25.1906 21.9092 25.375 21.4641 25.375 21V6.125C25.375 5.89294 25.2828 5.67038 25.1187 5.50628C24.9546 5.34219 24.7321 5.25 24.5 5.25ZM22.2502 7L14 14.5633L5.74984 7H22.2502ZM23.625 21H4.375V8.11453L13.4083 16.3953C13.5697 16.5435 13.7809 16.6257 14 16.6257C14.2191 16.6257 14.4303 16.5435 14.5917 16.3953L23.625 8.11453V21Z",fill:"currentColor"})})}function I1({size:n=28,className:s,...e}){return t.jsx("svg",{width:n,height:n,viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:s,...e,children:t.jsx("path",{d:"M14.875 13.125V23.625C14.875 23.8571 14.7828 24.0796 14.6187 24.2437C14.4546 24.4078 14.2321 24.5 14 24.5C13.7679 24.5 13.5454 24.4078 13.3813 24.2437C13.2172 24.0796 13.125 23.8571 13.125 23.625V13.125C13.125 12.8929 13.2172 12.6704 13.3813 12.5063C13.5454 12.3422 13.7679 12.25 14 12.25C14.2321 12.25 14.4546 12.3422 14.6187 12.5063C14.7828 12.6704 14.875 12.8929 14.875 13.125ZM21.875 21C21.6429 21 21.4204 21.0922 21.2563 21.2563C21.0922 21.4204 21 21.6429 21 21.875V23.625C21 23.8571 21.0922 24.0796 21.2563 24.2437C21.4204 24.4078 21.6429 24.5 21.875 24.5C22.1071 24.5 22.3296 24.4078 22.4937 24.2437C22.6578 24.0796 22.75 23.8571 22.75 23.625V21.875C22.75 21.6429 22.6578 21.4204 22.4937 21.2563C22.3296 21.0922 22.1071 21 21.875 21ZM24.5 17.5H22.75V4.375C22.75 4.14294 22.6578 3.92038 22.4937 3.75628C22.3296 3.59219 22.1071 3.5 21.875 3.5C21.6429 3.5 21.4204 3.59219 21.2563 3.75628C21.0922 3.92038 21 4.14294 21 4.375V17.5H19.25C19.0179 17.5 18.7954 17.5922 18.6313 17.7563C18.4672 17.9204 18.375 18.1429 18.375 18.375C18.375 18.6071 18.4672 18.8296 18.6313 18.9937C18.7954 19.1578 19.0179 19.25 19.25 19.25H24.5C24.7321 19.25 24.9546 19.1578 25.1187 18.9937C25.2828 18.8296 25.375 18.6071 25.375 18.375C25.375 18.1429 25.2828 17.9204 25.1187 17.7563C24.9546 17.5922 24.7321 17.5 24.5 17.5ZM6.125 17.5C5.89294 17.5 5.67038 17.5922 5.50628 17.7563C5.34219 17.9204 5.25 18.1429 5.25 18.375V23.625C5.25 23.8571 5.34219 24.0796 5.50628 24.2437C5.67038 24.4078 5.89294 24.5 6.125 24.5C6.35706 24.5 6.57962 24.4078 6.74372 24.2437C6.90781 24.0796 7 23.8571 7 23.625V18.375C7 18.1429 6.90781 17.9204 6.74372 17.7563C6.57962 17.5922 6.35706 17.5 6.125 17.5ZM8.75 14H7V4.375C7 4.14294 6.90781 3.92038 6.74372 3.75628C6.57962 3.59219 6.35706 3.5 6.125 3.5C5.89294 3.5 5.67038 3.59219 5.50628 3.75628C5.34219 3.92038 5.25 4.14294 5.25 4.375V14H3.5C3.26794 14 3.04538 14.0922 2.88128 14.2563C2.71719 14.4204 2.625 14.6429 2.625 14.875C2.625 15.1071 2.71719 15.3296 2.88128 15.4937C3.04538 15.6578 3.26794 15.75 3.5 15.75H8.75C8.98206 15.75 9.20462 15.6578 9.36872 15.4937C9.53281 15.3296 9.625 15.1071 9.625 14.875C9.625 14.6429 9.53281 14.4204 9.36872 14.2563C9.20462 14.0922 8.98206 14 8.75 14ZM16.625 8.75H14.875V4.375C14.875 4.14294 14.7828 3.92038 14.6187 3.75628C14.4546 3.59219 14.2321 3.5 14 3.5C13.7679 3.5 13.5454 3.59219 13.3813 3.75628C13.2172 3.92038 13.125 4.14294 13.125 4.375V8.75H11.375C11.1429 8.75 10.9204 8.84219 10.7563 9.00628C10.5922 9.17038 10.5 9.39294 10.5 9.625C10.5 9.85706 10.5922 10.0796 10.7563 10.2437C10.9204 10.4078 11.1429 10.5 11.375 10.5H16.625C16.8571 10.5 17.0796 10.4078 17.2437 10.2437C17.4078 10.0796 17.5 9.85706 17.5 9.625C17.5 9.39294 17.4078 9.17038 17.2437 9.00628C17.0796 8.84219 16.8571 8.75 16.625 8.75Z",fill:"currentColor"})})}const v1="_root_1e6uq_1",b1={root:v1};function S1({size:n=18,className:s,...e}){return t.jsx("svg",{width:n,height:n,viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:[b1.root,s].filter(Boolean).join(" "),...e,children:t.jsx("path",{d:"M8.9375 0C7.16983 0 5.44186 0.524175 3.97209 1.50624C2.50233 2.48831 1.35679 3.88415 0.680331 5.51727C0.00387248 7.15038 -0.17312 8.94741 0.171736 10.6811C0.516591 12.4148 1.36781 14.0073 2.61774 15.2573C3.86767 16.5072 5.46018 17.3584 7.19388 17.7033C8.92759 18.0481 10.7246 17.8711 12.3577 17.1947C13.9909 16.5182 15.3867 15.3727 16.3688 13.9029C17.3508 12.4331 17.875 10.7052 17.875 8.9375C17.8725 6.5679 16.9301 4.29606 15.2545 2.6205C13.5789 0.944933 11.3071 0.00250234 8.9375 0ZM8.9375 16.5C7.44178 16.5 5.97965 16.0565 4.736 15.2255C3.49236 14.3945 2.52305 13.2134 1.95066 11.8315C1.37828 10.4497 1.22851 8.92911 1.52032 7.46213C1.81212 5.99515 2.53237 4.64764 3.59001 3.59001C4.64764 2.53237 5.99515 1.81211 7.46213 1.52031C8.92911 1.22851 10.4497 1.37827 11.8315 1.95066C13.2134 2.52305 14.3945 3.49235 15.2255 4.736C16.0565 5.97965 16.5 7.44178 16.5 8.9375C16.4977 10.9425 15.7002 12.8647 14.2825 14.2825C12.8647 15.7002 10.9425 16.4977 8.9375 16.5ZM13.0625 8.9375C13.0625 9.11984 12.9901 9.29471 12.8611 9.42364C12.7322 9.55257 12.5573 9.625 12.375 9.625H9.625V12.375C9.625 12.5573 9.55257 12.7322 9.42364 12.8611C9.29471 12.9901 9.11984 13.0625 8.9375 13.0625C8.75517 13.0625 8.5803 12.9901 8.45137 12.8611C8.32244 12.7322 8.25 12.5573 8.25 12.375V9.625H5.5C5.31767 9.625 5.1428 9.55257 5.01387 9.42364C4.88494 9.29471 4.8125 9.11984 4.8125 8.9375C4.8125 8.75516 4.88494 8.5803 5.01387 8.45136C5.1428 8.32243 5.31767 8.25 5.5 8.25H8.25V5.5C8.25 5.31766 8.32244 5.1428 8.45137 5.01386C8.5803 4.88493 8.75517 4.8125 8.9375 4.8125C9.11984 4.8125 9.29471 4.88493 9.42364 5.01386C9.55257 5.1428 9.625 5.31766 9.625 5.5V8.25H12.375C12.5573 8.25 12.7322 8.32243 12.8611 8.45136C12.9901 8.5803 13.0625 8.75516 13.0625 8.9375Z",fill:"currentColor"})})}function k1({size:n=24,className:s,...e}){return t.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:s,...e,children:[t.jsx("path",{d:"M11 19C15.4183 19 19 15.4183 19 11C19 6.58172 15.4183 3 11 3C6.58172 3 3 6.58172 3 11C3 15.4183 6.58172 19 11 19Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),t.jsx("path",{d:"M21 21L16.65 16.65",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function B1({size:n=26,className:s,...e}){return t.jsx("svg",{width:n,height:n,viewBox:"0 0 26 26",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:s,...e,children:t.jsx("path",{d:"M13 0C10.4288 0 7.91543 0.762437 5.77759 2.1909C3.63975 3.61935 1.97351 5.64968 0.989572 8.02512C0.0056327 10.4006 -0.251811 13.0144 0.249797 15.5362C0.751405 18.0579 1.98953 20.3743 3.80762 22.1924C5.6257 24.0105 7.94208 25.2486 10.4638 25.7502C12.9856 26.2518 15.5995 25.9944 17.9749 25.0104C20.3503 24.0265 22.3807 22.3603 23.8091 20.2224C25.2376 18.0846 26 15.5712 26 13C25.9964 9.5533 24.6256 6.24882 22.1884 3.81163C19.7512 1.37445 16.4467 0.00363977 13 0ZM13 24C10.8244 24 8.69767 23.3549 6.88873 22.1462C5.07979 20.9375 3.66989 19.2195 2.83733 17.2095C2.00477 15.1995 1.78693 12.9878 2.21137 10.854C2.63581 8.72022 3.68345 6.7602 5.22183 5.22183C6.76021 3.68345 8.72022 2.6358 10.854 2.21136C12.9878 1.78692 15.1995 2.00476 17.2095 2.83733C19.2195 3.66989 20.9375 5.07979 22.1462 6.88873C23.3549 8.69767 24 10.8244 24 13C23.9967 15.9164 22.8367 18.7123 20.7745 20.7745C18.7123 22.8367 15.9164 23.9967 13 24ZM14.5 13C14.5 13.2967 14.412 13.5867 14.2472 13.8334C14.0824 14.08 13.8481 14.2723 13.574 14.3858C13.2999 14.4993 12.9983 14.5291 12.7074 14.4712C12.4164 14.4133 12.1491 14.2704 11.9393 14.0607C11.7296 13.8509 11.5867 13.5836 11.5288 13.2926C11.471 13.0017 11.5007 12.7001 11.6142 12.426C11.7277 12.1519 11.92 11.9176 12.1667 11.7528C12.4133 11.588 12.7033 11.5 13 11.5C13.3978 11.5 13.7794 11.658 14.0607 11.9393C14.342 12.2206 14.5 12.6022 14.5 13ZM20 13C20 13.2967 19.912 13.5867 19.7472 13.8334C19.5824 14.08 19.3481 14.2723 19.074 14.3858C18.7999 14.4993 18.4983 14.5291 18.2074 14.4712C17.9164 14.4133 17.6491 14.2704 17.4393 14.0607C17.2296 13.8509 17.0867 13.5836 17.0288 13.2926C16.9709 13.0017 17.0007 12.7001 17.1142 12.426C17.2277 12.1519 17.42 11.9176 17.6667 11.7528C17.9133 11.588 18.2033 11.5 18.5 11.5C18.8978 11.5 19.2794 11.658 19.5607 11.9393C19.842 12.2206 20 12.6022 20 13ZM9.00001 13C9.00001 13.2967 8.91203 13.5867 8.74721 13.8334C8.58239 14.08 8.34812 14.2723 8.07403 14.3858C7.79994 14.4993 7.49834 14.5291 7.20737 14.4712C6.9164 14.4133 6.64912 14.2704 6.43935 14.0607C6.22957 13.8509 6.08671 13.5836 6.02883 13.2926C5.97095 13.0017 6.00065 12.7001 6.11419 12.426C6.22772 12.1519 6.41998 11.9176 6.66665 11.7528C6.91332 11.588 7.20333 11.5 7.50001 11.5C7.89783 11.5 8.27936 11.658 8.56067 11.9393C8.84197 12.2206 9.00001 12.6022 9.00001 13Z",fill:"currentColor"})})}function N1({size:n=24,className:s,...e}){return t.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:s,...e,children:[t.jsx("path",{d:"M12 5V19",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),t.jsx("path",{d:"M5 12H19",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function H1({size:n=22,className:s,...e}){return t.jsx("svg",{width:n,height:n,viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:s,...e,children:t.jsx("path",{d:"M16.9873 16.0162C17.1156 16.145 17.1876 16.3195 17.1876 16.5013C17.1876 16.6831 17.1156 16.8576 16.9873 16.9864C16.8936 17.0784 14.6798 19.25 11 19.25C7.7868 19.25 5.45445 17.325 4.125 15.8254V17.875C4.125 18.0573 4.05257 18.2322 3.92364 18.3611C3.7947 18.4901 3.61984 18.5625 3.4375 18.5625C3.25516 18.5625 3.0803 18.4901 2.95136 18.3611C2.82243 18.2322 2.75 18.0573 2.75 17.875V13.75C2.75 13.5677 2.82243 13.3928 2.95136 13.2639C3.0803 13.1349 3.25516 13.0625 3.4375 13.0625H7.5625C7.74484 13.0625 7.9197 13.1349 8.04864 13.2639C8.17757 13.3928 8.25 13.5677 8.25 13.75C8.25 13.9323 8.17757 14.1072 8.04864 14.2361C7.9197 14.3651 7.74484 14.4375 7.5625 14.4375H4.76437C5.82312 15.7566 7.99219 17.875 11 17.875C14.0938 17.875 15.9964 16.0308 16.0153 16.0119C16.1448 15.8836 16.3199 15.812 16.5022 15.8128C16.6844 15.8136 16.8589 15.8868 16.9873 16.0162ZM18.5625 3.4375C18.3802 3.4375 18.2053 3.50993 18.0764 3.63886C17.9474 3.7678 17.875 3.94266 17.875 4.125V6.17461C16.5455 4.675 14.2132 2.75 11 2.75C7.32016 2.75 5.10641 4.92164 5.01359 5.01359C4.88436 5.14237 4.81158 5.31721 4.81126 5.49964C4.81094 5.68208 4.8831 5.85718 5.01187 5.98641C5.14065 6.11564 5.31549 6.18842 5.49793 6.18874C5.68036 6.18906 5.85546 6.1169 5.98469 5.98813C6.00359 5.96922 7.90625 4.125 11 4.125C14.0078 4.125 16.1769 6.24336 17.2356 7.5625H14.4375C14.2552 7.5625 14.0803 7.63493 13.9514 7.76386C13.8224 7.8928 13.75 8.06766 13.75 8.25C13.75 8.43234 13.8224 8.6072 13.9514 8.73614C14.0803 8.86507 14.2552 8.9375 14.4375 8.9375H18.5625C18.7448 8.9375 18.9197 8.86507 19.0486 8.73614C19.1776 8.6072 19.25 8.43234 19.25 8.25V4.125C19.25 3.94266 19.1776 3.7678 19.0486 3.63886C18.9197 3.50993 18.7448 3.4375 18.5625 3.4375Z",fill:"currentColor"})})}function M1({size:n=22,className:s,...e}){return t.jsx("svg",{width:n,height:n,viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:s,...e,children:t.jsx("path",{d:"M17.1875 11C17.1875 11.1823 17.1151 11.3572 16.9861 11.4861C16.8572 11.6151 16.6823 11.6875 16.5 11.6875H5.5C5.31766 11.6875 5.1428 11.6151 5.01386 11.4861C4.88493 11.3572 4.8125 11.1823 4.8125 11C4.8125 10.8177 4.88493 10.6428 5.01386 10.5139C5.1428 10.3849 5.31766 10.3125 5.5 10.3125H16.5C16.6823 10.3125 16.8572 10.3849 16.9861 10.5139C17.1151 10.6428 17.1875 10.8177 17.1875 11ZM19.9375 6.1875H2.0625C1.88016 6.1875 1.7053 6.25993 1.57636 6.38886C1.44743 6.5178 1.375 6.69266 1.375 6.875C1.375 7.05734 1.44743 7.2322 1.57636 7.36114C1.7053 7.49007 1.88016 7.5625 2.0625 7.5625H19.9375C20.1198 7.5625 20.2947 7.49007 20.4236 7.36114C20.5526 7.2322 20.625 7.05734 20.625 6.875C20.625 6.69266 20.5526 6.5178 20.4236 6.38886C20.2947 6.25993 20.1198 6.1875 19.9375 6.1875ZM13.0625 14.4375H8.9375C8.75516 14.4375 8.5803 14.5099 8.45136 14.6389C8.32243 14.7678 8.25 14.9427 8.25 15.125C8.25 15.3073 8.32243 15.4822 8.45136 15.6111C8.5803 15.7401 8.75516 15.8125 8.9375 15.8125H13.0625C13.2448 15.8125 13.4197 15.7401 13.5486 15.6111C13.6776 15.4822 13.75 15.3073 13.75 15.125C13.75 14.9427 13.6776 14.7678 13.5486 14.6389C13.4197 14.5099 13.2448 14.4375 13.0625 14.4375Z",fill:"currentColor"})})}const E1="_nameCell_eojwq_1",L1="_nameTitle_eojwq_13",A1="_nameCategory_eojwq_23",F1="_vendorCell_eojwq_33",D1="_rowActions_eojwq_41",Z1="_actionPlus_eojwq_53",P1="_actionDots_eojwq_91",T1="_table_eojwq_119",V1="_ratingValueLow_eojwq_263",W1="_paginationGray_eojwq_273",R1="_paginationBlack_eojwq_281",y={nameCell:E1,nameTitle:L1,nameCategory:A1,vendorCell:F1,rowActions:D1,actionPlus:Z1,actionDots:P1,table:T1,ratingValueLow:V1,paginationGray:W1,paginationBlack:R1};function $1(){const n=x(C=>C.items),s=x(C=>C.sortBy),e=x(C=>C.sortOrder),a=x(C=>C.columnWidths),c=x(C=>C.setSort),i=x(C=>C.getProduct),[m,h]=f.useState([]),d=f.useMemo(()=>{if(!s)return n;const C=e==="asc"?1:-1;return[...n].sort((l,r)=>{const u=l[s]??"",o=r[s]??"";return typeof u=="number"&&typeof o=="number"?(u-o)*C:String(u).localeCompare(String(o))*C})},[n,s,e]),g=f.useMemo(()=>[{title:"Наименование",dataIndex:"title",key:"title",width:a.title??240,sorter:!0,sortOrder:s==="title"?e==="asc"?"ascend":"descend":null,render:(C,l)=>{const r=i(l.id)??l,u=r.category??"";return t.jsxs("div",{className:y.nameCell,children:[t.jsx(M,{productId:l.id,field:"title",value:r.title,className:y.nameTitle}),u&&t.jsx("span",{className:y.nameCategory,children:u})]})}},{title:"Вендор",dataIndex:"brand",key:"brand",width:a.brand??120,sorter:!0,sortOrder:s==="brand"?e==="asc"?"ascend":"descend":null,render:(C,l)=>{const r=i(l.id)??l;return t.jsx("span",{className:y.vendorCell,children:t.jsx(M,{productId:l.id,field:"brand",value:r.brand})})}},{title:"Артикул",dataIndex:"sku",key:"sku",width:a.sku??120,render:(C,l)=>{const r=i(l.id)??l;return t.jsx(M,{productId:l.id,field:"sku",value:r.sku})}},{title:"Оценка",dataIndex:"rating",key:"rating",width:100,sorter:!0,sortOrder:s==="rating"?e==="asc"?"ascend":"descend":null,render:(C,l)=>{const u=(i(l.id)??l).rating??0,o=u<3;return t.jsx("span",{className:o?y.ratingValueLow:void 0,children:typeof u=="number"?`${u.toFixed(1)}/5`:"—"})}},{title:"Цена, ₽",dataIndex:"price",key:"price",width:130,sorter:!0,sortOrder:s==="price"?e==="asc"?"ascend":"descend":null,render:(C,l)=>{const u=(i(l.id)??l).price;return t.jsx(M,{productId:l.id,field:"price",value:u})}},{title:"Количество",dataIndex:"stock",key:"stock",width:140,align:"center",render:(C,l)=>{const u=(i(l.id)??l).stock??0;return t.jsx(x1,{value:u,max:100})}},{title:"",key:"actions",width:100,align:"center",render:()=>t.jsxs("div",{className:y.rowActions,children:[t.jsx(k,{type:"primary",size:"small",icon:t.jsx(N1,{size:16}),className:y.actionPlus}),t.jsx(k,{type:"text",size:"small",icon:t.jsx(B1,{size:20}),className:y.actionDots})]})}],[a,s,e,i]),_=(C,l,r)=>{const u=Array.isArray(r)?r[0]:r;(u==null?void 0:u.field)!=null&&u.order&&c(u.field,u.order==="ascend"?"asc":"desc")},I={selectedRowKeys:m,onChange:C=>h(C)};return t.jsx(U,{rowKey:"id",rowSelection:I,columns:g,dataSource:d,onChange:_,pagination:{pageSize:20,showSizeChanger:!0,showTotal:(C,l)=>t.jsxs(t.Fragment,{children:[t.jsx("span",{className:y.paginationGray,children:"Показано"})," ",t.jsxs("span",{className:y.paginationBlack,children:[l[0],"-",l[1]]})," ",t.jsx("span",{className:y.paginationGray,children:"из"})," ",t.jsx("span",{className:y.paginationBlack,children:C})]}),size:"default",showTitle:!1},locale:{emptyText:"Нет данных"},className:y.table})}const O1="id,title,price,rating,brand,sku,minimumOrderQuantity,category,stock";function q1(n){const s=n.q?"/products/search":"/products",e=new URLSearchParams;return n.q&&e.set("q",n.q),e.set("select",O1),n.limit!=null&&e.set("limit",String(n.limit)),n.skip!=null&&e.set("skip",String(n.skip)),n.sortBy&&e.set("sortBy",n.sortBy),n.order&&e.set("order",n.order),`${s}?${e.toString()}`}async function U1(n={},s){return X(q1(n),s)}async function K1(n,s){return e1("/products/add",n,s)}const z1="_priceInput_11qnv_1",G1="_submitBtn_11qnv_9",V={priceInput:z1,submitBtn:G1};function Q1({onCancel:n,onSuccess:s}){const e=W(d=>d.token),a=x(d=>d.addLocalProduct),[c]=b.useForm(),[i,m]=f.useState(!1),h=async d=>{m(!0);try{const g=await K1({title:d.title.trim(),price:d.price,brand:d.brand.trim(),sku:d.sku.trim()},{token:e??void 0});a(g),s(),c.resetFields()}catch{c.setFields([{name:"title",errors:["Ошибка добавления. Повторите попытку."]}])}finally{m(!1)}};return t.jsx(K,{title:"Новый товар",size:"small",className:"add-product-card",children:t.jsxs(b,{form:c,layout:"vertical",onFinish:h,initialValues:{price:0},children:[t.jsxs(z,{gutter:16,children:[t.jsx(H,{xs:24,sm:12,md:6,children:t.jsx(b.Item,{name:"title",label:"Наименование",rules:[{required:!0,message:"Обязательное поле"}],children:t.jsx(B,{placeholder:"Наименование"})})}),t.jsx(H,{xs:24,sm:12,md:6,children:t.jsx(b.Item,{name:"price",label:"Цена",rules:[{required:!0,message:"Обязательное поле"},{type:"number",min:0,message:"Цена не может быть отрицательной"}],children:t.jsx(R,{placeholder:"Цена",min:0,step:.01,className:V.priceInput,controls:!1,onKeyDown:d=>{["Backspace","Tab","Enter","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Delete"].includes(d.key)||/^[0-9.,]$/.test(d.key)||d.preventDefault()},parser:d=>{if(!d)return 0;const g=String(d).replace(/[^\d.,]/g,"").replace(",","."),_=parseFloat(g);return Number.isNaN(_)?0:_}})})}),t.jsx(H,{xs:24,sm:12,md:6,children:t.jsx(b.Item,{name:"brand",label:"Вендор",rules:[{required:!0,message:"Обязательное поле"}],children:t.jsx(B,{placeholder:"Вендор"})})}),t.jsx(H,{xs:24,sm:12,md:6,children:t.jsx(b.Item,{name:"sku",label:"Артикул",rules:[{required:!0,message:"Обязательное поле"}],children:t.jsx(B,{placeholder:"Артикул"})})})]}),t.jsxs(b.Item,{children:[t.jsx(k,{type:"primary",htmlType:"submit",loading:i,className:V.submitBtn,children:"Сохранить"}),t.jsx(k,{onClick:n,disabled:i,children:"Отмена"})]})]})})}function J1(n,s){let e;return function(...a){clearTimeout(e),e=setTimeout(()=>n.apply(this,a),s)}}const Y1="_page_3p0ts_1",X1="_header_3p0ts_21",e2="_title_3p0ts_49",t2="_headerSeparator_3p0ts_67",n2="_headerRight_3p0ts_83",s2="_search_3p0ts_105",r2="_searchIcon_3p0ts_221",o2="_headerIconBtn_3p0ts_237",a2="_bellBadge_3p0ts_279",i2="_headerIconSvg_3p0ts_305",c2="_loading_3p0ts_357",l2="_alert_3p0ts_369",d2="_section_3p0ts_377",u2="_sectionHeader_3p0ts_391",C2="_sectionTitle_3p0ts_409",h2="_sectionActions_3p0ts_423",p2="_refreshBtn_3p0ts_435",m2="_filterBtn_3p0ts_481",g2="_refreshIcon_3p0ts_493",_2="_filterSectionIcon_3p0ts_545",f2="_addBtn_3p0ts_553",x2="_addBtnIcon_3p0ts_653",p={page:Y1,header:X1,title:e2,headerSeparator:t2,headerRight:n2,search:s2,searchIcon:r2,headerIconBtn:o2,bellBadge:a2,headerIconSvg:i2,loading:c2,alert:l2,section:d2,sectionHeader:u2,sectionTitle:C2,sectionActions:h2,refreshBtn:p2,filterBtn:m2,refreshIcon:g2,filterSectionIcon:_2,addBtn:f2,addBtnIcon:x2},w2=400;function b2(){const{message:n}=G.useApp(),s=W(o=>o.token),e=x(o=>o.loading),a=x(o=>o.searchQuery),c=x(o=>o.setItems),i=x(o=>o.setLoading),m=x(o=>o.setError),h=x(o=>o.setSearchQuery),d=x(o=>o.error),[g,_]=f.useState(!1),[I,C]=f.useState(a),l=f.useCallback(async o=>{i(!0),m(null);try{const j=await U1({q:(o==null?void 0:o.trim())||void 0,limit:100},{token:s??void 0});c(j.products)}catch(j){m(j instanceof Error?j.message:"Ошибка загрузки"),c([])}finally{i(!1)}},[s,c,i,m]);f.useEffect(()=>{l(a)},[a,l]);const r=f.useCallback(J1(o=>h(o),w2),[]);f.useEffect(()=>{r(I)},[I]);const u=f.useCallback(()=>{n.success("Товар успешно добавлен"),_(!1)},[n]);return t.jsxs("div",{className:p.page,children:[t.jsxs("header",{className:p.header,children:[t.jsx("h1",{className:p.title,children:"Товары"}),t.jsxs("div",{className:p.headerRight,children:[t.jsx(B,{placeholder:"Найти",prefix:t.jsx(k1,{size:20,className:p.searchIcon}),value:I,onChange:o=>C(o.target.value),allowClear:!0,className:p.search}),t.jsx("span",{className:p.headerSeparator,"aria-hidden":!0}),t.jsx("button",{type:"button",className:p.headerIconBtn,"aria-label":"Язык",children:t.jsx(w1,{size:20,className:p.headerIconSvg})}),t.jsx(Q,{count:12,size:"small",color:"#797FE9",offset:[-4,2],className:p.bellBadge,children:t.jsx("button",{type:"button",className:p.headerIconBtn,"aria-label":"Уведомления",children:t.jsx(j1,{size:20,className:p.headerIconSvg})})}),t.jsx("button",{type:"button",className:p.headerIconBtn,"aria-label":"Почта",children:t.jsx(y1,{size:20,className:p.headerIconSvg})}),t.jsx("button",{type:"button",className:p.headerIconBtn,"aria-label":"Фильтры",children:t.jsx(I1,{size:20,className:p.headerIconSvg})})]})]}),e&&t.jsx("div",{className:p.loading,children:t.jsx(J,{size:"large"})}),d&&t.jsx(Y,{type:"error",message:d,showIcon:!0,className:p.alert}),t.jsxs("section",{className:p.section,children:[t.jsxs("div",{className:p.sectionHeader,children:[t.jsx("h2",{className:p.sectionTitle,children:"Все позиции"}),t.jsxs("div",{className:p.sectionActions,children:[t.jsx(k,{type:"text",icon:t.jsx(H1,{size:22,className:p.refreshIcon}),onClick:()=>l(a),title:"Обновить",className:p.refreshBtn}),t.jsx(k,{type:"text",icon:t.jsx(M1,{size:22,className:p.filterSectionIcon}),title:"Фильтр",className:p.filterBtn}),t.jsx(k,{type:"primary",icon:t.jsx(S1,{size:18,className:p.addBtnIcon}),onClick:()=>_(!0),disabled:g,className:p.addBtn,children:"Добавить"})]})]}),g&&t.jsx(Q1,{onCancel:()=>_(!1),onSuccess:u}),t.jsx($1,{})]})]})}export{b2 as ProductsPage};
